@using System.Reflection
@inject DialogService DialogService

@inherits PageBaseComponent
<RadzenTemplateForm TItem="WbsInfo" Data="@model" Submit=@OnSubmit>
  <RadzenStack Gap="1rem">
    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Wrap="FlexWrap.Wrap">
      <RadzenLabel Text="Title" Style="width: 6rem;" />
      <RadzenTextBox @bind-Value="@model.proc_nm" Name="Text" Style="width: 12rem;" />
      <RadzenRequiredValidator Component="Text" Text="Title is required" />
    </RadzenStack>
    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Wrap="FlexWrap.Wrap">
      <RadzenLabel Text="Start" Style="width: 6rem;" />
      <RadzenDatePicker @bind-Value="@model.plan_sdt" Name="Start"  Style="width: 12rem;" DateFormat="yyyy-MM-dd" />
      <RadzenRequiredValidator Component="Start" Text="Start is required" />
    </RadzenStack>
    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Wrap="FlexWrap.Wrap">
      <RadzenLabel Text="End" Style="width: 6rem;" />
      <RadzenDatePicker Name="End" @bind-Value="@model.plan_edt"  Style="width: 12rem;" DateFormat="yyyy-MM-dd" />
      <RadzenRequiredValidator Component="End" Text="End is required" />
    </RadzenStack>
    <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.End">
      <RadzenButton ButtonType="ButtonType.Submit" Text="Save" />
    </RadzenStack>
  </RadzenStack>
</RadzenTemplateForm>
@code {
  [Parameter]  public WbsInfo Appointment { get; set; }

  WbsInfo model = new WbsInfo();

  protected override void OnParametersSet() {
    model = Appointment;
  }

  async Task OnSubmit(WbsInfo model) {
    
    Dictionary<string, string> dic = model.ToDictionary();

    await DbSave<Dictionary<string, object>>("sp_proj_wbs_exec", dic);

    DialogService.Close(model);
  }




  

}